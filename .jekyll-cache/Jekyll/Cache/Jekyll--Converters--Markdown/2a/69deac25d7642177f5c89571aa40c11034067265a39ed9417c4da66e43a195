I"çJ<h1 id="interf√≠cie-dusuari-i-navegaci√≥">Interf√≠cie d‚Äôusuari i navegaci√≥</h1>

<p>#Com administrar animacions de moviment i ginys amb MotionLayout</p>

<p><a href="https://developer.android.com/reference/androidx/constraintlayout/motion/widget/MotionLayout">MotionLayout</a> MotionLayout √©s un tipus de disseny que t‚Äôajuda a administrar les animacions de moviment i widgets en la teua app. MotionLayout √©s una subclasse de ConstraintLayout i es basa en les seues capacitats de disseny enriquit. Com a part de la biblioteca de ConstraintLayout, MotionLayout est√† disponible com una biblioteca de compatibilitat i √©s compatible amb versions anteriors a la API nivell 14.</p>

<p><img src="./images/motion1.gif" alt="motion layout" /></p>

<p>MotionLayout redueix les difer√®ncies entre les transicions de disseny i el maneig de moviment complex, la qual cosa ofereix una combinaci√≥ de caracter√≠stiques entre el marc d‚Äôanimaci√≥ de propietats<a href="https://developer.android.com/guide/topics/graphics/prop-animation">marc d‚Äôanimaci√≥ de propietats</a>  , <a href="https://developer.android.com/training/transitions">TransitionManager</a> TransitionManager i <a href="https://developer.android.com/reference/androidx/coordinatorlayout/widget/CoordinatorLayout">CoordinatorLayout</a> CoordinatorLayout.</p>

<p>A m√©s de descriure les transicions entre dissenys, MotionLayout tamb√© et permet animar qualsevol propietat de disseny. A m√©s, √©s inherentment compatible amb les transicions que admeten cerques. Aix√≤ significa que pots mostrar de manera instant√†nia qualsevol punt dins de la transici√≥ en funci√≥ d‚Äôalguna condici√≥, com l‚Äôentrada t√†ctil. MotionLayout tamb√© admet fotogrames clau, la qual cosa habilita l‚Äô√∫s de transicions totalment personalitzades per a satisfer les teues necessitats.</p>

<p>MotionLayout √©s totalment declaratiu, la qual cosa significa que pots descriure qualsevol transici√≥ en XML, independentment de la seua complexitat.</p>

<blockquote>
  <p>Nota: MotionLayout funciona nom√©s amb els seus elements secundaris directes. No admet jerarquies de disseny anidat ni transicions d‚Äôactivitats.</p>
</blockquote>

<h2 id="consideracions-del-disseny">Consideracions del disseny</h2>

<p>MotionLayout est√† dissenyat per a moure, canviar la grand√†ria i animar els elements de la IU amb els quals interactuen els usuaris, com a botons i barres de t√≠tols. En la teua app, el moviment no ha de ser simplement un efecte especial injustificat. S‚Äôha d‚Äôusar per a ajudar els usuaris a comprendre el que fa la teua app. Per a obtindre m√©s informaci√≥ sobre com dissenyar una app amb moviment, consulta la secci√≥ Material Design en Informaci√≥ sobre el moviment<a href="https://material.io/design/motion/understanding-motion.html">Informaci√≥ sobre el moviment</a>.</p>

<h2 id="comen√ßar">Comen√ßar</h2>

<p>Segueix aquests passos per a comen√ßar a usar MotionLayout en el teu projecte.</p>

<ul>
  <li><strong>Inclou la depend√®ncia</strong> <em>ConstraintLayout</em>: per a usar MotionLayout en el teu projecte, agrega la depend√®ncia ConstraintLayout 2.0 a l‚Äôarxiu build.gradle de la teua app. Si uses AndroidX, agrega la seg√ºent depend√®ncia:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dependencies {
	implementation 'androidx.constraintlayout:constraintlayout:2.0.0-beta1'
}
</code></pre></div></div>

<p>Si no uses AndroidX, agrega la seg√ºent depend√®ncia de la biblioteca de compatibilitat:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dependencies {
 implementation 'com.android.support.constraint:constraint-layout:2.0.0-beta1'
}
</code></pre></div></div>

<ul>
  <li>Crea un arxiu <code class="language-plaintext highlighter-rouge">MotionLayout: MotionLayout</code> √©s una subclasse de ConstraintLayout, de manera que pots transformar qualsevol ConstraintLayout existent en un MotionLayout si reemplaces el nom de la classe en el teu arxiu de recursos de disseny, com es mostra en els seg√ºents exemples:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- before: ConstraintLayout --&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout .../&gt;
&lt;!-- after: MotionLayout --&gt;
&lt;androidx.constraintlayout.motion.widget.MotionLayout .../&gt;
</code></pre></div></div>

<p>Aquest √©s un exemple complet d‚Äôun arxiu MotionLayout que pots usar per a crear el moviment en la figura anterior:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!-- activity_main.xml --&gt;
&lt;androidx.constraintlayout.motion.giny.MotionLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:app="http://schemas.android.com/apk/res-auto"
xmlns:tools="http://schemas.android.com/tools"
android:aneu="@+aneu/motionLayout"
android:layout_width="match_parent"
android:layout_height="match_parent"
app:layoutDescription="@xml/scene_01"
tools:showPaths="true"&gt;

&lt;View
android:id="@+id/button"
android:layout_width="64dp"
android:layout_height="64dp"
android:background="@color/colorAccent"
android:text="Button" /&gt;

&lt;/androidx.constraintlayout.motion.widget.MotionLayout&gt;
</code></pre></div></div>

<ul>
  <li>Crea un arxiu MotionScene: en l‚Äôexemple de MotionLayout anterior, l‚Äôatribut app:layoutDescription fa refer√®ncia a un MotionScene. MotionScene √©s un arxiu XML de recursos que cont√© totes les descripcions de moviments per al disseny corresponent. A fi de mantindre la informaci√≥ de disseny separada de les descripcions de moviments, cada MotionLayout fa refer√®ncia a un arxiu MotionScene separat. Tingues en compte que les definicions de MotionScene tenen prioritat sobre qualsevol definici√≥ similar de MotionLayout.</li>
</ul>

<p>El seg√ºent √©s un exemple d‚Äôarxiu MotionScene en el qual es descriu el moviment horitzontal b√†sic en la figura anterior:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;MotionScene xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:motion="http://schemas.android.com/apk/res-auto"&gt;

&lt;Transition
motion:constraintSetStart="@+id/start"
motion:constraintSetEnd="@+id/end"
motion:duration="1000"&gt;
&lt;OnSwipe
motion:touchAnchorId="@+id/button"
motion:touchAnchorSide="right"
motion:dragDirection="dragRight" /&gt;
&lt;/Transition&gt;

&lt;ConstraintSet android:id="@+id/start"&gt;
&lt;Constraint
android:id="@+id/button"
android:layout_width="64dp"
android:layout_height="64dp"
android:layout_marginStart="8dp"
motion:layout_constraintBottom_toBottomOf="parent"
motion:layout_constraintStart_toStartOf="parent"
motion:layout_constraintTop_toTopOf="parent" /&gt;
&lt;/ConstraintSet&gt;

&lt;ConstraintSet android:id="@+id/end"&gt;
&lt;Constraint
android:id="@+id/button"
android:layout_width="64dp"
android:layout_height="64dp"
android:layout_marginEnd="8dp"
motion:layout_constraintBottom_toBottomOf="parent"
motion:layout_constraintEnd_toEndOf="parent"
motion:layout_constraintTop_toTopOf="parent" /&gt;
&lt;/ConstraintSet&gt;

&lt;/MotionScene&gt;
</code></pre></div></div>

<p>Tingues en compte el seg√ºent:</p>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">&lt;Transition&gt;</code></strong> cont√© la definici√≥ b√†sica del moviment.
    <ul>
      <li><strong>motion:constraintSetStart</strong> i <strong>motion:constraintSetEnd</strong> s√≥n refer√®ncies als extrems del moviment. S‚Äôinclou la definici√≥ d‚Äôaquests extrems en els elements <code class="language-plaintext highlighter-rouge">&lt;ConstraintSet&gt;</code> m√©s endavant, en l‚Äôarxiu MotionScene.</li>
      <li><strong>motion:duration</strong> especifica la quantitat de mil¬∑lisegons que tarda a completar-se el moviment.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">&lt;OnSwipe&gt;</code></strong> et permet controlar el moviment a trav√©s del tacte.
    <ul>
      <li><strong>motion:touchAnchorId</strong> fa refer√®ncia a la vista que pots lliscar i arrossegar.</li>
      <li><strong>motion:touchAnchorSide</strong> indica que s‚Äôarrossega la vista des del costat dret.</li>
      <li><strong>motion:dragDirection</strong> fa refer√®ncia a la direcci√≥ de progr√©s de l‚Äôarrossegament. Per exemple, <strong>motion:dragDirection=‚ÄùdragRight‚Äù</strong> indica que el progr√©s augmenta a mesura que arrossegues cap a la dreta.</li>
    </ul>
  </li>
  <li>
    <ConstraintSet> √©s on has de definir les diverses restriccions que descriuen el teu moviment. En aquest exemple, definim un ConstraintSet per a cada extrem del nostre moviment. Aquests extrems estan centrats verticalment (a trav√©s d'app:layout_constraintTop_toTopOf="parent" i app:layout_constraintBottom_toBottomOf="parent"). De manera horitzontal, els extrems estan en els l√≠mits esquerre i dret de la pantalla.

</ConstraintSet>
  </li>
</ul>
<p>Per a obtindre una vista m√©s detallada dels diversos elements compatibles amb MotionScene, consulta els exemples de MotionLayout<a href="https://developer.android.com/training/constraint-layout/motion-layout-examples">exemples de MotionLayout</a>.</p>

<h2 id="atributs-interpolats">Atributs interpolats</h2>

<p>Dins d‚Äôun arxiu MotionScene, els elements ConstraintSet poden contindre atributs addicionals que s‚Äôinterpolen durant la transici√≥. A m√©s de la posici√≥ i els l√≠mits, MotionLayout interpola els seg√ºents atributs:</p>

<ul>
  <li>alpha</li>
  <li>visibility</li>
  <li>elevation</li>
  <li>rotation, rotationX, rotationY</li>
  <li>translationX, translationY, translationZ</li>
  <li>scaleX, scaleY</li>
</ul>

<h2 id="atributs-personalitzats">Atributs personalitzats</h2>

<p>Dins d‚Äôun <code class="language-plaintext highlighter-rouge">&lt;Constraint&gt;</code>, pots usar l‚Äôelement <code class="language-plaintext highlighter-rouge">&lt;CustomAttribute&gt;</code> per a especificar una transici√≥ per als atributs que no estan simplement relacionats amb la posici√≥ o els atributs View.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Constraint
android:id="@+id/button" ...&gt;
&lt;CustomAttribute
motion:attributeName="backgroundColor"
motion:customColorValue="#D81B60"/&gt;
&lt;/Constraint&gt;
</code></pre></div></div>

<p>Un <code class="language-plaintext highlighter-rouge">&lt;CustomAttribute&gt;</code> cont√© dos atributs propis:</p>

<ul>
  <li><strong>motion:attributeName</strong> √©s obligatori i ha de coincidir amb un objecte que tinga m√®todes get i set. Aquests han de coincidir amb un patr√≥ espec√≠fic. Per exemple, backgroundColor √©s compatible, ja que la nostra vista t√© m√®todes <strong>getBackgroundColor()</strong> i <strong>setBackgroundColor()</strong> subjacents.</li>
  <li>L‚Äôaltre atribut que has de proporcionar es basa en la mena de valor. Tria entre els seg√ºents tipus admesos:
    <ul>
      <li><strong>motion:customColorValue</strong> per als colors</li>
      <li><strong>motion:customIntegerValue</strong> per a nombres enters</li>
      <li><strong>motion:customFloatValue</strong> per a valors flotants</li>
      <li><strong>motion:customStringValue</strong> per a strings</li>
      <li><strong>motion:customDimension</strong> per a dimensions</li>
      <li><strong>motion:customBoolean</strong> per a valors booleans</li>
    </ul>
  </li>
</ul>

<p>Tingues en compte que quan especifiques un atribut personalitzat, has de definir valors d‚Äôextrem en els elements <code class="language-plaintext highlighter-rouge">&lt;ConstraintSet&gt;</code> d‚Äôinici i de finalitzaci√≥.</p>

<h3 id="exemple-canviar-el-color-de-fons">Exemple: Canviar el color de fons</h3>

<p>Basant-nos en el nostre exemple anterior, fem que la vista canvie de color mentre es mou, com es mostra en la figura seg√ºent.</p>

<p><img src="./images/motion2.gif" alt="motion layout" /></p>

<p>Agrega un element <strong><code class="language-plaintext highlighter-rouge">&lt;CustomAttribute&gt;</code></strong> a cada element <strong>ConstraintSet</strong>, com es mostra a continuaci√≥:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ConstraintSet android:id="@+id/start"&gt;
&lt;Constraint
android:id="@+id/button"
android:layout_width="64dp"
android:layout_height="64dp"
android:layout_marginStart="8dp"
motion:layout_constraintBottom_toBottomOf="parent"
motion:layout_constraintStart_toStartOf="parent"
motion:layout_constraintTop_toTopOf="parent"&gt;
&lt;CustomAttribute
motion:attributeName="backgroundColor"
motion:customColorValue="#D81B60" /&gt;
&lt;/Constraint&gt;
&lt;/ConstraintSet&gt;

&lt;ConstraintSet android:id="@+id/end"&gt;
&lt;Constraint
android:id="@+id/button"
android:layout_width="64dp"
android:layout_height="64dp"
android:layout_marginEnd="8dp"
motion:layout_constraintBottom_toBottomOf="parent"
motion:layout_constraintEnd_toEndOf="parent"
motion:layout_constraintTop_toTopOf="parent"&gt;
&lt;CustomAttribute
motion:attributeName="backgroundColor"
motion:customColorValue="#9999FF" /&gt;
&lt;/Constraint&gt;
&lt;/ConstraintSet&gt;
</code></pre></div></div>

<h2 id="atributs-addicionals-de-motionlayout">Atributs addicionals de MotionLayout</h2>

<p>A m√©s dels atributs que es mostren en l‚Äôexemple anterior, <strong>MotionLayout</strong> t√© altres atributs que conv√© especificar:</p>

<ul>
  <li><strong>app:applyMotionScene=‚Äùboolean‚Äù</strong> indica si s‚Äôha d‚Äôaplicar l‚Äôarxiu MotionScene. El valor predeterminat per a aquest atribut √©s true.</li>
  <li><strong>app:showPaths=‚Äùboolean‚Äù</strong> indica si es mostren les rutes de moviment mentre s‚Äôexecuta el moviment. El valor predeterminat per a aquest atribut √©s false.</li>
  <li><strong>app:progress=‚Äùfloat‚Äù</strong> et permet especificar expl√≠citament el progr√©s de la transici√≥. Pots usar qualsevol valor de punt flotant des de 0 (l‚Äôinici de la transici√≥) fins a 1 (el final de la transici√≥).</li>
  <li><strong>app:currentState=‚Äùreference‚Äù</strong> et permet especificar un ConstraintSet espec√≠fic.</li>
  <li><strong>app:motionDebug</strong> et permet mostrar informaci√≥ addicional de depuraci√≥ sobre el moviment. Els valors possibles s√≥n ‚ÄúXOU_PROGRESS‚Äù, ‚ÄúXOU_PATH‚Äù o ‚ÄúXOU_ALL‚Äù.</li>
</ul>

<h2 id="recursos-addicionals">Recursos addicionals</h2>

<p>Per a obtindre m√©s informaci√≥ sobre MotionLayout, consulta els seg√ºents vincles:</p>

<p><a href="https://codelabs.developers.google.com/codelabs/motion-layout">Com usar MotionLayout per a animar apps per a Android (codelab)</a> 
<a href="https://developer.android.com/training/constraint-layout/motion-layout-examples">Exemples de MotionLayout</a> Exemples de MotionLayout
<a href="https://github.com/android/views-widgets-samples/tree/master/ConstraintLayoutExamples">Mostres de MotionLayout/ConstraintLayout (GitHub)</a> 
<a href="https://medium.com/google-developers/introduction-to-motionlayout-part-i-29208674b10d">Introducci√≥ a MotionLayout (part I)</a>
<a href="https://medium.com/google-developers/introduction-to-motionlayout-part-ii-a31acc084f59">Introducci√≥ a MotionLayout (part II)</a>
<a href="https://medium.com/google-developers/introduction-to-motionlayout-part-iii-47cd64d51a5">Introducci√≥ a MotionLayout (part III)</a>
<a href="https://medium.com/google-developers/defining-motion-paths-in-motionlayout-6095b874d37">Introducci√≥ a MotionLayout (part IV)</a></p>

<h2 id="referencies-xml-de-motion-layout">Referencies XML de Motion Layout</h2>

<p>MotionLayout usa un arxiu d‚Äôambient en moviment per a definir una seq√º√®ncia de moviment. Un arxiu d‚Äôambient en moviment √©s un arxiu XML que especifica tots els aspectes d‚Äôuna seq√º√®ncia de moviment. El node <MotionLayout> de l'arxiu de disseny cont√© un atribut app:layoutDescription que apunta a l'arxiu d'ambient en moviment.</MotionLayout></p>

<p>Aquesta refer√®ncia no √©s exhaustiva. Proporciona informaci√≥ sobre els elements m√©s importants de l‚Äôarxiu d‚Äôambient en moviment i els seus atributs m√©s utilitzats.</p>

<ul>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/motionscene"><strong><code class="language-plaintext highlighter-rouge">&lt;MotionScene&gt;</code></strong></a> L‚Äôelement arrel d‚Äôun arxiu d‚Äôambient en moviment.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/constraintset"><strong><code class="language-plaintext highlighter-rouge">&lt;ConstraintSet&gt;</code></strong></a>Especifica les posicions i els atributs de totes les vistes en un punt d‚Äôuna seq√º√®ncia de moviment.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/constraint"><strong><code class="language-plaintext highlighter-rouge">&lt;Constraint&gt;</code></strong></a>Especifica la ubicaci√≥ i els atributs d‚Äôun dels elements en una seq√º√®ncia de moviment.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/transition"><strong><code class="language-plaintext highlighter-rouge">&lt;Transition&gt;</code></strong></a>Especifica els estats d‚Äôinici i fi d‚Äôuna seq√º√®ncia de moviment, qualsevol estat intermedi desitjat i les interaccions de l‚Äôusuari que activen la seq√º√®ncia.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/onclick"><strong><code class="language-plaintext highlighter-rouge">&lt;onClick&gt;</code></strong></a>Especifica l‚Äôacci√≥ que s‚Äôha de realitzar quan l‚Äôusuari pressiona una vista espec√≠fica.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/onswipe"><strong><code class="language-plaintext highlighter-rouge">&lt;onSwipe&gt;</code></strong></a>Especifica l‚Äôacci√≥ que ha de realitzar quan l‚Äôusuari llisca el dit sobre el disseny.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/keyframeset"><strong><code class="language-plaintext highlighter-rouge">&lt;KeyFrameSet&gt;</code></strong></a>Especifica la ubicaci√≥ i els atributs de les vistes en el transcurs de la seq√º√®ncia de moviment.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/keyposition"><strong><code class="language-plaintext highlighter-rouge">&lt;KeyPosition&gt;</code></strong></a>Especifica la ubicaci√≥ d‚Äôuna vista en un moment espec√≠fic durant la seq√º√®ncia de moviment.</li>
  <li><a href="https://developer.android.com/training/constraint-layout/motionlayout/ref/keyattribute"><strong><code class="language-plaintext highlighter-rouge">&lt;KeyAttribute&gt;</code></strong></a>Especifica els atributs d‚Äôuna vista en un moment espec√≠fic durant la seq√º√®ncia de moviment.</li>
</ul>

<p><a href="../..">back</a></p>
:ET